micronaut:
  application:
    name: msg-platform-worker-test
  server:
    port: -1  # Random port for integration tests
  caches:
    default:
      initial-capacity: 10

datasources:
  default:
    url: jdbc:h2:mem:workerdb;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password: ''
    dialect: POSTGRES
    schema-generate: NONE
    maximum-pool-size: 10

flyway:
  datasources:
    default:
      enabled: true
      locations:
        - "classpath:db/migration/h2"  # H2-specific migrations for testing
      placeholders:
        schema: ""  # Empty schema for H2 (no schema prefix needed)

jms:
  consumers:
    enabled: true
  connection-factory-jndi-name: ConnectionFactory
  client-id: worker-test-client

activemq:
  pool:
    enabled: true
    max-connections: 8
    idle-timeout: 30000
    expiry-timeout: 0

db:
  dialect: H2  # Used by @Requires(property = "db.dialect", value = "H2")

# Test environment marker
test:
  active: true

# Disable unnecessary services for testing
logger:
  levels:
    org.apache.activemq: WARN
    jakarta.jms: DEBUG
    com.acme.reliable: DEBUG
    org.flywaydb: INFO
